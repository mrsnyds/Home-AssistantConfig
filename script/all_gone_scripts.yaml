# In the time frame between sunset and 23:00 (when random lights are on), 
# the SMS is only sent if some device other than random lights are on.
all_gone_random:
  alias: All Gone Random
  sequence: 
  - condition: template
    value_template: '{{ is_state("group.not_home_random", "on") }}'
  - condition: state
    entity_id: input_boolean.guest_mode
    state: 'off'        
  - service: notify.aws_lambda_1
    data_template:
      target: 'arn:aws:lambda:us-west-2:152624716237:function:myPythonSMS'
      message: >  
        MESSAGE FROM YOUR HOUSE: I am turning your lights on and off randomly,
        which means you are away at night, but other stuff should be off.  Check here:
        https://mrsnyds.duckdns.org:8123/lovelace/0 
      data:
        send_to: frank_and_kathy        
# In the time frame is NOT between sunset and 23:00 (when random lights are on), 
# send teh SMS if anything is on that should not be on.
all_gone_not_random:
  alias: All Gone Not Random
  sequence:
  - condition: template
    value_template: '{{ is_state("group.not_home_on", "on") }}'  
  - condition: state
    entity_id: input_boolean.guest_mode
    state: 'off'    
  - service: notify.aws_lambda_1      
    data_template:
      target: 'arn:aws:lambda:us-west-2:152624716237:function:myPythonSMS'
      message: >  
        MESSAGE FROM YOUR HOUSE: Nobody (that we track) has been home for over
        15 minutes, but stuff is on.  Check here:
        https://mrsnyds.duckdns.org:8123/lovelace/0
      data:
        send_to: frank_and_kathy
# Turn on dehumidifier when we are gone, with the below conditions being met
dehumidify_while_gone:
  alias: Dehumidify While Gone
  sequence:
  - condition: state
    entity_id: input_boolean.guest_mode
    state: 'off'
  - condition: state
    entity_id: input_boolean.dehumidifier_active
    state: 'on'    
  - condition: template
    value_template: '{{ is_state("switch.merry_and_bright", "off") }}'     
  - service: switch.turn_on    
    entity_id: switch.merry_and_bright   

